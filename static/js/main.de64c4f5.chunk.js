(this.webpackJsonpbukh=this.webpackJsonpbukh||[]).push([[0],{11:function(e){e.exports=JSON.parse('{"users":[{"user_id":1,"username":"Anton"},{"user_id":2,"username":"Max"},{"user_id":3,"username":"Sonya"},{"user_id":4,"username":"Arina"},{"user_id":5,"username":"Alisa"}]}')},12:function(e){e.exports=JSON.parse('{"activities":[{"activity_id":1,"activity_name":"son","users_id":[1,2,3,5],"items_id":[4]},{"activity_id":2,"activity_name":"sport","users_id":[1],"items_id":[5]},{"activity_id":3,"activity_name":"booze","users_id":[1,2,5],"items_id":[2,6]},{"activity_id":4,"activity_name":"veggies","users_id":[1,2,3,4,5],"items_id":[1,3]}]}')},13:function(e){e.exports=JSON.parse('{"items":[{"item_id":1,"item_name":"avokado","item_price":50,"bought_by":5},{"item_id":2,"item_name":"pivo","item_price":70,"bought_by":2},{"item_id":3,"item_name":"arbuz","item_price":100,"bought_by":1},{"item_id":4,"item_name":"lamp","item_price":100,"bought_by":5},{"item_id":5,"item_name":"ball","item_price":70,"bought_by":1},{"item_id":6,"item_name":"martini","item_price":500,"bought_by":1}]}')},18:function(e,t,i){},19:function(e,t,i){},25:function(e,t,i){"use strict";i.r(t);var a=i(3),n=i.n(a),c=i(9),r=i.n(c),s=(i(18),i(1)),l=i(4),d=i(5),u=(i(19),i(2)),h=i(10),o=i.n(h),b=i(0);function v(e){var t=e.users.map((function(t){return Object(b.jsx)(D,{userID:t.user_id,value:t.username,handleDelete:e.handleDeleteUser,children:Object(b.jsx)(_,{value:t.username,id:t.user_id,handleChange:e.handleUsernameChange})},t.user_id)}));return Object(b.jsxs)("div",{className:"table-row users-row",children:[Object(b.jsx)("div",{className:"table-cell header-cell",children:"X"}),t,Object(b.jsx)(C,{handleAdd:e.handleAddUser}),Object(b.jsx)("div",{className:"table-cell header-cell",children:Object(b.jsx)("i",{children:"Expenses"})})]})}function m(e){var t=e.users.map((function(e){return Object(b.jsx)(y,{value:e.username},e.user_id)}));return Object(b.jsxs)("div",{className:"table-row users-row",children:[Object(b.jsx)("div",{className:"table-cell header-cell",children:"X"}),t,Object(b.jsx)("div",{className:"table-cell header-cell",children:Object(b.jsx)("i",{children:"Expenses"})})]})}function j(e){var t,i={buttonType:"activity"===e.type?"checkbox":"radio",editable:"activity"!==e.type},a=[],n=Object(u.a)(e.usersID);try{for(n.s();!(t=n.n()).done;){var c=t.value;a.push(Object(b.jsx)(O,{buttonType:i.buttonType},c))}}catch(r){n.e(r)}finally{n.f()}return a.push(Object(b.jsx)(O,{buttonType:i.buttonType},-1)),Object(b.jsxs)("div",{className:"table-row placeholder-row",children:[Object(b.jsx)(C,{id:e.activityID,handleAdd:e.handleAdd}),a,Object(b.jsx)("div",{className:"table-cell"})]})}function f(e){var t=Object.entries(e.expenses);return Object(b.jsxs)("div",{className:"table-row total-row",children:[Object(b.jsx)("div",{className:"table-cell header-cell",children:Object(b.jsx)("i",{children:e.rowName})}),t.map((function(e){return Object(b.jsx)(x,{value:e[1]},e[0])})),e.forPartyTable&&Object(b.jsx)("div",{className:"table-cell placeholder-cell"}),Object(b.jsx)("div",{className:"table-cell header-cell",children:"X"})]})}function y(e){return Object(b.jsx)("div",{className:"table-cell header-cell",children:Object(b.jsx)("div",{className:"header username",children:e.value.toString()})})}function O(e){return Object(b.jsx)("div",{className:"table-cell placeholder-cell",children:Object(b.jsx)("input",{className:"check-button placeholder-check-button",type:e.buttonType})})}function p(e){return Object(b.jsx)("div",{className:"header activity-name",onClick:function(){e.handleActivityClick(e.activityID)},children:e.value.toString()})}function x(e){return Object(b.jsx)("div",{className:"table-cell",children:Object(b.jsx)("div",{className:"table-cell expense-cell",children:e.value.toString()})})}function _(e){var t=Object(a.useRef)(),i=e.charLimit||7;return Object(b.jsx)(o.a,{className:e.activityHeader?"activity-header":"header",innerRef:t,html:e.value,spellCheck:!1,onChange:function(t){console.log(t.target.value),e.numbersOnly,e.handleChange(t.target.value,e.id)},onKeyDown:function(t){return function(e,t){if("Enter"===e.code&&e.preventDefault(),e.ctrlKey)switch(e.code){case"KeyB":case"KeyI":case"KeyU":e.preventDefault()}var a=["Backspace","Delete","ArrowLeft","ArrowRight","ArrowUp","ArrowDown"];!a.includes(e.code)&&e.target.innerHTML.length>=i&&e.preventDefault(),t&&e.target.innerHTML.includes(".")&&"Period"===e.code&&e.preventDefault();var n=new RegExp("[0-9.]");!t||a.includes(e.code)||n.test(e.key)||e.preventDefault()}(t,e.numbersOnly)},disabled:e.disabled})}function D(e){var t=Object(a.useState)(!1),i=Object(d.a)(t,2),n=i[0],c=i[1];return Object(b.jsxs)("div",{className:"table-cell header-cell",onMouseOver:function(){c(!0)},onMouseOut:function(){c(!1)},children:[Object(b.jsx)(I,{visible:n,handleDelete:e.handleDelete,userID:e.userID,activityID:e.activityID,itemID:e.itemID}),e.children]})}function C(e){return Object(b.jsx)("div",{className:"table-cell add-button-cell",children:Object(b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",onClick:function(){e.handleAdd(e.id)},width:"20",height:"100%",fill:"currentColor",className:"bi bi-plus",viewBox:"0 0 16 16",children:Object(b.jsx)("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})})})}function I(e){var t={userID:e.userID,activityID:e.activityID,itemID:e.itemID},i={position:"relative",right:45,display:e.visible?"block":"none"};return Object(b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",onClick:function(){e.handleDelete(t)},style:i,width:"20",height:"100%",fill:"currentColor",className:"bi bi-x",viewBox:"0 0 16 16",children:Object(b.jsx)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})})}function g(e){return Object(b.jsx)("div",{className:"table-cell checkbox-cell",children:Object(b.jsx)("input",{className:"check-button",type:"checkbox",defaultChecked:e.defaultChecked,onClick:function(t){e.handleCheckboxClick(t.target.checked,e.activityID,e.userID)}})})}function k(e){return Object(b.jsx)("div",{className:"table-cell radio-button-cell",children:Object(b.jsx)("input",{className:"check-button",type:"radio",name:e.itemID,defaultChecked:e.defaultChecked,onClick:function(){e.handleCheckboxClick(e.itemID,e.userID)}})})}function N(e){var t,i=[],a=Object(u.a)(e.partyUsersID);try{for(a.s();!(t=a.n()).done;){var n=t.value;i.push(Object(b.jsx)(g,{handleCheckboxClick:e.handleCheckboxClick,activityID:e.activityID,userID:n,defaultChecked:e.activityUsers.includes(n)},e.activityID.toString()+n.toString()))}}catch(c){a.e(c)}finally{a.f()}return Object(b.jsxs)("div",{className:"table-row activity-row",children:[Object(b.jsx)(D,{activityID:e.activityID,handleDelete:e.handleDeleteActivity,children:Object(b.jsx)(p,{activityID:e.activityID,value:e.activityName,handleActivityClick:e.handleActivityClick})}),i,Object(b.jsx)(O,{buttonType:"checkbox"}),Object(b.jsx)(x,{value:e.activityExpense})]})}var A=function(e){var t,i=e.users.map((function(e){return e.user_id})),a=function(e,t){var i,a={},n=Object(u.a)(e);try{var c=function(){var e=i.value;a[e.activity_id]=0;var n,c=t.filter((function(t){return e.items_id.includes(t.item_id)})),r=Object(u.a)(c);try{for(r.s();!(n=r.n()).done;){var s=n.value;a[e.activity_id]+=parseFloat(s.item_price)}}catch(l){r.e(l)}finally{r.f()}};for(n.s();!(i=n.n()).done;)c()}catch(r){n.e(r)}finally{n.f()}return a}(e.activities,e.items),n=function(e,t,i,a){var n,c={expenses:Object.fromEntries(e.map((function(e){return[e.user_id,0]}))),debt:Object.fromEntries(e.map((function(e){return[e.user_id,0]})))},r=Object(u.a)(t);try{var s=function(){var e,t=n.value,r=a[t.activity_id]/t.users_id.length,s=i.filter((function(e){return t.items_id.includes(e.item_id)})),l=Object(u.a)(t.users_id);try{for(l.s();!(e=l.n()).done;){var d=e.value;c.expenses[d]+=r,c.debt[d]+=r}}catch(v){l.e(v)}finally{l.f()}var h,o=Object(u.a)(s);try{for(o.s();!(h=o.n()).done;){var b=h.value;null!==b.bought_by&&(c.debt[b.bought_by]-=parseFloat(b.item_price))}}catch(v){o.e(v)}finally{o.f()}};for(r.s();!(n=r.n()).done;)s()}catch(d){r.e(d)}finally{r.f()}for(var l in c.expenses)c.expenses[l]=Math.round(100*c.expenses[l])/100,c.debt[l]=Math.round(100*c.debt[l])/100;return c}(e.users,e.activities,e.items,a),c=n.expenses,r=n.debt,s=[],l=Object(u.a)(e.activities);try{var d=function(){var n=t.value,c=n.activity_id,r=n.activity_name,l=n.users_id,d=e.items.filter((function(e){return n.items_id.includes(e.item_id)}));s.push(Object(b.jsx)(N,{activity:n,activityID:c,activityName:r,activityUsers:l,activityItems:d,activityExpense:a[c],partyUsersID:i,handleActivityClick:e.handleActivityClick,handleCheckboxClick:e.handleCheckboxClick,handleDeleteActivity:e.handleDeleteActivity},c))};for(l.s();!(t=l.n()).done;)d()}catch(h){l.e(h)}finally{l.f()}return s.push(Object(b.jsx)(j,{usersID:i,type:"activity",handleAdd:e.handleAddActivity},-1)),s.push(Object(b.jsx)(f,{rowName:"Total",expenses:c,forPartyTable:!0},-2)),s.push(Object(b.jsx)(f,{rowName:"Debt",expenses:r,forPartyTable:!0},-3)),s};var w=function(e){return Object(b.jsxs)("div",{className:"table-wrapper",children:[Object(b.jsx)("h1",{children:"Dacha"}),Object(b.jsxs)("div",{className:"table party-table",children:[Object(b.jsx)(v,{users:e.users,handleAddUser:e.handleAddUser,handleDeleteUser:e.handleDeleteUser,handleUsernameChange:e.handleUsernameChange}),Object(b.jsx)(A,{activities:e.activities,items:e.items,users:e.users,handleActivityClick:e.handleActivityClick,handleCheckboxClick:e.handleParticipationClick,handleAddActivity:e.handleAddActivity,handleDeleteActivity:e.handleDeleteActivity})]})]})};function U(e){var t,i=[],a=Object(u.a)(e.usersID);try{for(a.s();!(t=a.n()).done;){var n=t.value;i.push(Object(b.jsx)(k,{handleCheckboxClick:e.handleCheckboxClick,activityID:e.activityID,itemID:e.itemID,userID:n,defaultChecked:n===e.itemBoughtBy},e.itemID.toString()+n.toString()))}}catch(c){a.e(c)}finally{a.f()}return Object(b.jsxs)("div",{className:"table-row item-row",children:[Object(b.jsx)(D,{activityID:e.activityID,itemID:e.itemID,handleDelete:e.handleDeleteItem,children:Object(b.jsx)(_,{id:e.itemID,value:e.itemName,handleChange:e.handleItemNameChange})}),i,Object(b.jsx)("div",{className:"table-cell",children:Object(b.jsx)(_,{id:e.itemID,value:e.itemPrice.toString(),handleChange:e.handleExpenseChange,numbersOnly:!0})})]})}var S=function(e){var t,i=e.users.map((function(e){return e.user_id})),a=function(e,t){var i,a=Object.fromEntries(e.map((function(e){return[e,0]}))),n=Object(u.a)(t);try{for(n.s();!(i=n.n()).done;){var c=i.value;null!==c.bought_by&&(a[c.bought_by]+=parseFloat(c.item_price))}}catch(r){n.e(r)}finally{n.f()}return a}(i,e.items),n=[],c=Object(u.a)(e.items);try{for(c.s();!(t=c.n()).done;){var r=t.value,s=r.item_id,l=r.item_name,d=r.bought_by,h=r.item_price;n.push(Object(b.jsx)(U,{activityID:e.activity.activity_id,itemID:s,itemName:l,itemBoughtBy:d,itemPrice:h,usersID:i,handleCheckboxClick:e.handleCheckboxClick,handleDeleteItem:e.handleDeleteItem,handleItemNameChange:e.handleItemNameChange,handleExpenseChange:e.handleExpenseChange},s))}}catch(o){c.e(o)}finally{c.f()}return n.push(Object(b.jsx)(j,{usersID:i,handleAdd:e.handleAddItem,activityID:e.activity.activity_id},-1)),n.push(Object(b.jsx)(f,{rowName:"Total",expenses:a,forPartyTable:!1},-2)),n};var E=function(e){var t=e.selectedActivity,i=e.items.filter((function(e){return t.items_id.includes(e.item_id)}));return Object(b.jsxs)("div",{className:"table-wrapper",children:[Object(b.jsx)("h2",{children:Object(b.jsx)(_,{activityHeader:!0,value:t.activity_name,id:t.activity_id,handleChange:e.handleActivityNameChange,charLimit:20})}),Object(b.jsxs)("div",{className:"table activity-table",children:[Object(b.jsx)(m,{users:e.users,activityID:t.activity_id,handleAddUser:e.handleAddUser}),Object(b.jsx)(S,{activity:e.selectedActivity,users:e.users,items:i,handleCheckboxClick:e.handlePurchaseClick,handleAddItem:e.handleAddItem,handleDeleteItem:e.handleDeleteItem,handleActivityNameChange:e.handleActivityNameChange,handleItemNameChange:e.handleItemNameChange,handleExpenseChange:e.handleExpenseChange})]})]})},T=i(11),P=i(12),M=i(13);var L=function(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),i=t[0],n=t[1],c=Object(a.useState)([]),r=Object(d.a)(c,2),u=r[0],h=r[1],o=Object(a.useState)(),v=Object(d.a)(o,2),m=v[0],j=v[1],f=Object(a.useState)([]),y=Object(d.a)(f,2),O=y[0],p=y[1];Object(a.useEffect)((function(){n(T.users),h(P.activities),p(M.items)}),[]);var x=function(e,t){return Math.max.apply(Math,Object(l.a)(e.map((function(e){return e[t]}))))},_=function(){if(i.length>=10)alert("Cannot add a user: 10 users max");else{var e={user_id:x(i,"user_id")+1,username:"User"};n((function(t){return[].concat(Object(l.a)(t),[e])}))}},D=function(e,t,i){h((function(a){return a.map((function(a){if(a.activity_id===e){var n=Object(l.a)(a.items_id);return"add"===i?n.push(t):n.splice(n.indexOf(t),1),m&&m.activity_id===e&&j(Object(s.a)(Object(s.a)({},a),{},{items_id:n})),Object(s.a)(Object(s.a)({},a),{},{items_id:n})}return a}))}))};return Object(b.jsx)("div",{className:"App",children:Object(b.jsxs)("div",{className:"tables-container",children:[Object(b.jsx)(w,{users:i,activities:u,items:O,handleActivityClick:function(e){if(m&&0===m.activity_name.length)alert("Activity should have name");else{var t=u.find((function(t){return t.activity_id===e}));j(t)}},handleParticipationClick:function(e,t,i){h((function(a){return a.map((function(a){if(a.activity_id===t){var n=Object(l.a)(a.users_id);return e?n.push(i):n.splice(n.indexOf(i),1),m&&m.activity_id===t&&j(Object(s.a)(Object(s.a)({},a),{},{users_id:n})),Object(s.a)(Object(s.a)({},a),{},{users_id:n})}return a}))}))},handleAddUser:_,handleDeleteUser:function(e){O.some((function(t){return t.bought_by===e.userID}))?alert("Cannot remove the user: they have items purchased"):(h((function(t){return t.map((function(t){var i=Object(l.a)(t.users_id);return i.includes(e.userID)&&i.splice(i.indexOf(e.userID),1),Object(s.a)(Object(s.a)({},t),{},{users_id:i})}))})),n((function(t){return t.filter((function(t){return t.user_id!==e.userID}))})))},handleUsernameChange:function(e,t){n((function(i){return i.map((function(i){return i.user_id===t?Object(s.a)(Object(s.a)({},i),{},{username:e}):i}))}))},handleAddActivity:function(){var e={activity_id:x(u,"activity_id")+1,activity_name:"Activity",users_id:[],items_id:[]};h((function(t){return[].concat(Object(l.a)(t),[e])})),j(e)},handleDeleteActivity:function(e){h((function(t){return t.filter((function(t){return t.activity_id!==e.activityID}))})),j()}}),m?Object(b.jsx)(E,{users:i,selectedActivity:m,items:O,handlePurchaseClick:function(e,t){p((function(i){return i.map((function(i){return i.item_id===e?Object(s.a)(Object(s.a)({},i),{},{bought_by:t}):i}))}))},handleAddUser:_,handleAddItem:function(e){var t=x(O,"item_id")+1,i={item_id:t,item_name:"Item",item_price:0,bought_by:null};p((function(e){return[].concat(Object(l.a)(e),[i])})),D(e,t,"add")},handleDeleteItem:function(e){p((function(t){return t.filter((function(t){return t.item_id!==e.itemID}))})),D(e.activityID,e.itemID,"delete")},handleActivityNameChange:function(e,t){h((function(i){return i.map((function(i){return i.activity_id===t?(m&&m.activity_id===t&&j(Object(s.a)(Object(s.a)({},i),{},{activity_name:e})),Object(s.a)(Object(s.a)({},i),{},{activity_name:e})):i}))}))},handleItemNameChange:function(e,t){p((function(i){return i.map((function(i){return i.item_id===t?Object(s.a)(Object(s.a)({},i),{},{item_name:e}):i}))}))},handleExpenseChange:function(e,t){p((function(i){return i.map((function(i){return i.item_id===t?Object(s.a)(Object(s.a)({},i),{},{item_price:e}):i}))}))}}):Object(b.jsxs)("div",{children:[Object(b.jsx)("br",{}),Object(b.jsx)("p",{children:"select an activity"})]})]})})},B=function(e){e&&e instanceof Function&&i.e(3).then(i.bind(null,26)).then((function(t){var i=t.getCLS,a=t.getFID,n=t.getFCP,c=t.getLCP,r=t.getTTFB;i(e),a(e),n(e),c(e),r(e)}))};r.a.render(Object(b.jsx)(n.a.StrictMode,{children:Object(b.jsx)(L,{})}),document.getElementById("root")),B()}},[[25,1,2]]]);
//# sourceMappingURL=main.de64c4f5.chunk.js.map